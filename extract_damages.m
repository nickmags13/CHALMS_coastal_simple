%%%%%%%%%%%% Extract damages %%%%%%%%%%%%%%%%%%%%%%%%%%%
cd C:\Users\nrmagliocca\'Box Sync'\'Data Drive'\model_results\CHALMS_event_ilandscape_011718_popgrow
load results_event_ilandscape_011718_popgrow

cell2mile=0.0395;   %cell side equals 0.0395 mi
cell2ft=cell2mile*5280;
NWIDTH=80;
MRUNS=30;
NCELLS=NWIDTH*NWIDTH;
COAST=zeros(NWIDTH,NWIDTH);
SCAPE=zeros(NWIDTH,NWIDTH);
SCAPE(COAST~=1)=1;

coastdist=reshape(NWIDTH+1-cumsum(SCAPE,2),NCELLS,1);

housedam=10.23749-0.23462*(coastdist*cell2ft/1000)+...
    0.001649*(coastdist*cell2ft/1000).^2;

rentmaps=mapdata_store.avgrentmap(:,61:90);
landmaps=mapdata_store.landvaluemap(:,61:90);

rentdata=zeros(NCELLS,MRUNS,3);
rentdata(:,:,1)=cat(2,rentmaps{17,:});
rentdata(:,:,2)=cat(2,rentmaps{23,:});
rentdata(:,:,3)=cat(2,rentmaps{30,:});

landdata=zeros(NCELLS,MRUNS,3);
landdata(:,:,1)=cat(2,landmaps{17,:});
landdata(:,:,2)=cat(2,landmaps{23,:});
landdata(:,:,3)=cat(2,landmaps{30,:});
        
idmgclass1=(NCELLS-NWIDTH+1):NCELLS;
idmgclass2=(NCELLS-NWIDTH*11+1):(NCELLS-NWIDTH);
idmgclass3=1:(NCELLS-NWIDTH*11);

dmg1data=zeros(3,3);
dmg1rents=zeros(3,3);
dmg1houses=zeros(3,3);
dmg1land=zeros(3,3);
subrents=rentdata(:,:,1);
inrents=subrents(idmgclass1,:);
inrents=inrents(inrents~=0);
dmg1rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg1rents(1,:)=dmg1rentstats(2:4);
nhouses=sum((subrents(idmgclass1,:) ~= 0),1);
dmg1housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg1houses(1,:)=dmg1housestats(2:4);
indata=subrents(idmgclass1,:).*(housedam(idmgclass1)./100);
indata=indata(indata~=0);
dmg1stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg1data(1,:)=dmg1stats(2:4);
subland=landdata(:,:,1);
inland=subland(idmgclass1,:);
inland=inland(inland~=0);
dmg1landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg1land(1,:)=dmg1landstats(2:4);
subrents=rentdata(:,:,2);
inrents=subrents(idmgclass1,:);
inrents=inrents(inrents~=0);
dmg1rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg1rents(2,:)=dmg1rentstats(2:4);
nhouses=sum((subrents(idmgclass1,:) ~= 0),1);
dmg1housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg1houses(2,:)=dmg1housestats(2:4);
indata=subrents(idmgclass1,:).*(housedam(idmgclass1)./100);
indata=indata(indata~=0);
dmg1stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg1data(2,:)=dmg1stats(2:4);
subland=landdata(:,:,2);
inland=subland(idmgclass1,:);
inland=inland(inland~=0);
dmg1landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg1land(2,:)=dmg1landstats(2:4);
subrents=rentdata(:,:,3);
inrents=subrents(idmgclass1,:);
inrents=inrents(inrents~=0);
dmg1rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg1rents(3,:)=dmg1rentstats(2:4);
nhouses=sum((subrents(idmgclass1,:) ~= 0),1);
dmg1housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg1houses(3,:)=dmg1housestats(2:4);
indata=subrents(idmgclass1,:).*(housedam(idmgclass1)./100);
indata=indata(indata~=0);
dmg1stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg1data(3,:)=dmg1stats(2:4);
subland=landdata(:,:,3);
inland=subland(idmgclass1,:);
inland=inland(inland~=0);
dmg1landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg1land(3,:)=dmg1landstats(2:4);

dmg2data=zeros(3,3);
dmg2rents=zeros(3,3);
dmg2houses=zeros(3,3);
dmg2land=zeros(3,3);
subrents=rentdata(:,:,1);
inrents=subrents(idmgclass2,:);
inrents=inrents(inrents~=0);
dmg2rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg2rents(1,:)=dmg2rentstats(2:4);
nhouses=sum((subrents(idmgclass2,:) ~= 0),1);
dmg2housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg2houses(1,:)=dmg2housestats(2:4);
indata=subrents(idmgclass2,:).*(housedam(idmgclass2)./100);
indata=indata(indata~=0);
dmg2stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg2data(1,:)=dmg2stats(2:4);
subland=landdata(:,:,1);
inland=subland(idmgclass2,:);
inland=inland(inland~=0);
dmg2landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg2land(1,:)=dmg2landstats(2:4);
subrents=rentdata(:,:,2);
inrents=subrents(idmgclass2,:);
inrents=inrents(inrents~=0);
dmg2rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg2rents(2,:)=dmg2rentstats(2:4);
nhouses=sum((subrents(idmgclass2,:) ~= 0),1);
dmg2housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg2houses(2,:)=dmg2housestats(2:4);
indata=subrents(idmgclass2,:).*(housedam(idmgclass2)./100);
indata=indata(indata~=0);
dmg2stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg2data(2,:)=dmg2stats(2:4);
subland=landdata(:,:,2);
inland=subland(idmgclass2,:);
inland=inland(inland~=0);
dmg2landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg2land(2,:)=dmg2landstats(2:4);
subrents=rentdata(:,:,3);
inrents=subrents(idmgclass2,:);
inrents=inrents(inrents~=0);
dmg2rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg2rents(3,:)=dmg2rentstats(2:4);
nhouses=sum((subrents(idmgclass2,:) ~= 0),1);
dmg2housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg2houses(3,:)=dmg2housestats(2:4);
indata=subrents(idmgclass2,:).*(housedam(idmgclass2)./100);
indata=indata(indata~=0);
dmg2stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg2data(3,:)=dmg2stats(2:4);
subland=landdata(:,:,3);
inland=subland(idmgclass2,:);
inland=inland(inland~=0);
dmg2landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg2land(3,:)=dmg2landstats(2:4);

dmg3data=zeros(3,3);
dmg3rents=zeros(3,3);
dmg3houses=zeros(3,3);
dmg3land=zeros(3,3);
subrents=rentdata(:,:,1);
inrents=subrents(idmgclass3,:);
inrents=inrents(inrents~=0);
dmg3rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg3rents(1,:)=dmg3rentstats(2:4);
nhouses=sum((subrents(idmgclass3,:) ~= 0),1);
dmg3housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg3houses(1,:)=dmg3housestats(2:4);
indata=subrents(idmgclass3,:).*(housedam(idmgclass3)./100);
indata=indata(indata~=0);
dmg3stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg3data(1,:)=dmg3stats(2:4);
subland=landdata(:,:,1);
inland=subland(idmgclass3,:);
inland=inland(inland~=0);
dmg3landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg3land(1,:)=dmg3landstats(2:4);
subrents=rentdata(:,:,2);
inrents=subrents(idmgclass3,:);
inrents=inrents(inrents~=0);
dmg3rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg3rents(2,:)=dmg3rentstats(2:4);
nhouses=sum((subrents(idmgclass3,:) ~= 0),1);
dmg3housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg3houses(2,:)=dmg3housestats(2:4);
indata=subrents(idmgclass3,:).*(housedam(idmgclass3)./100);
indata=indata(indata~=0);
dmg3stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg3data(2,:)=dmg3stats(2:4);
subland=landdata(:,:,1);
inland=subland(idmgclass3,:);
inland=inland(inland~=0);
dmg3landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg3land(2,:)=dmg3landstats(2:4);
subrents=rentdata(:,:,3);
inrents=subrents(idmgclass3,:);
inrents=inrents(inrents~=0);
dmg3rentstats=quantile(inrents,[0.05 0.25 0.5 0.75 0.95]);
dmg3rents(3,:)=dmg3rentstats(2:4);
nhouses=sum((subrents(idmgclass3,:) ~= 0),1);
dmg3housestats=quantile(nhouses,[0.05 0.25 0.5 0.75 0.95]);
dmg3houses(3,:)=dmg3housestats(2:4);
indata=subrents(idmgclass3,:).*(housedam(idmgclass3)./100);
indata=indata(indata~=0);
dmg3stats=quantile(indata,[0.05 0.25 0.5 0.75 0.95]);
dmg3data(3,:)=dmg3stats(2:4);
subland=landdata(:,:,1);
inland=subland(idmgclass3,:);
inland=inland(inland~=0);
dmg3landstats=quantile(inland,[0.05 0.25 0.5 0.75 0.95]);
dmg3land(3,:)=dmg3landstats(2:4);